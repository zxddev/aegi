<!-- Author: msq -->

# AEGI 单一规划文档（v0.3）

> 本文档是当前阶段唯一的规划入口（Single Source of Truth）。
> 其他历史文档保留为参考，不再作为范围和优先级决策依据。

---

## 1. 文档定位（只保留一个入口）

- 唯一入口：`docs/v0.3/single-source-plan.md`
- 目标：用最小复杂度统一“战略目标、分期范围、验收标准、架构边界”。
- 原则：不堆概念，不并行维护多份路线图，不做重复定义。

历史文档的使用规则：

- `docs/foundry/v0.2/*.md`：作为架构和 P0 合同参考。
- `docs/archive/需求研究/*.md`：作为研究素材和方案备选库。
- `docs/archive/plans/*.md`：作为历史执行计划参考。

---

## 2. 当前基线（代码已具备的能力）

当前代码不是空壳，已具备 P0 骨架：

- 证据链核心对象与 API 已存在（Case/Artifact/Chunk/Evidence/SourceClaim/Assertion/Judgment/ToolTrace）。
- 写操作与审计边界已成型（Action-only 思路 + Tool trace 记录）。
- 网关治理框架已存在（`aegi-mcp-gateway` 的工具入口与策略层）。

结论：下一步应以“增量扩展”为主，不做推倒重来。

---

## 3. 新需求目标（按冲击力排序）

1. 多语言语义理解与跨语言实体对齐
2. 假设生成与检验（ACH 自动化）
3. 叙事分析与信息战检测
4. 预测分析（预警与情景）
5. 对话式分析（自然语言查询 + 证据链）
6. 自动化知识图谱构建与演化
7. 元认知（偏见检测、盲区发现、可信度评分）

核心竞争力定义：

- 不是“有 AI”，而是“AI 输出可回源、可审计、可回放、可质疑”。

---

## 4. 分期范围（简化为 P1/P2/P3）

## P1（近期，优先做差异化）

范围：

- 多语言语义理解 + 跨语言实体对齐
- 对话式分析 MVP（自然语言到结构化查询）
- 自动化 claim 抽取（SourceClaim-first）

验收：

- 多语言样例集可稳定回归。
- 每条对话答案可点击回源到 SourceClaim/Evidence/ArtifactVersion。
- 抽取结果具备最小质量门槛（grounding rate 达标）。

## P2（中期，形成分析能力壁垒）

范围：

- ACH 假设生成与证据支持/反驳评分
- 叙事分析与协调传播检测
- 自动化知识图谱构建（含实体消歧基础能力）

验收：

- 假设-证据关系可追溯，可导出解释路径。
- 叙事传播链可回放，冲突叙事可并存展示。
- 图谱增量更新可复跑，结果可审计。

## P3（远期，高级推理）

范围：

- 预测分析与预警
- 元认知能力（偏见、盲区、可信度）
- 情景推演

验收：

- 预警规则和输出具备可解释依据。
- 每个 Judgment 有可解释可信度评分。
- 盲区和偏差提示可纳入分析流程闭环。

---

## 5. 架构红线（任何阶段都不能破）

1. Evidence-first + Archive-first
2. SourceClaim-first
3. Action-only writes
4. 工具外联统一走 Gateway（策略可审计）
5. 派生索引可重建（权威源在 Postgres + 对象存储）

说明：以上红线优先级高于功能迭代速度。

---

## 6. 代码改动策略（保持简单）

- 优先“加法”：补字段、增模型、增模块。
- 谨慎“改法”：仅在局部复杂度过高时做小重构。
- 禁止“重写”：不推倒现有证据链主干。

当前明确需要先做的一处重构：

- 拆分 `code/aegi-core/src/aegi_core/api/routes/cases.py` 中过长的导入流程，迁移到 service 层，避免后续 AI 流水线继续堆在路由层。

---

## 7. 能力到模块映射（最小落地视图）

- 多语言：`aegi-core` 的 SourceClaim/Extraction 相关模型与服务。
- 对话式分析：`aegi-core` 新增 query/chat API 层，`aegi-web` 后续接入。
- ACH/叙事：`aegi-core` 新增 Hypothesis/Narrative 领域模型与评估服务。
- 图谱演化：`aegi-core` 的 ontology/resolution 相关模块（先关系化实现，再扩展派生图索引）。
- 预测/元认知：先接入 regression 与监控指标体系，再扩展推理服务。

---

## 8. 维护规则（避免再次文档分裂）

- 规则 1：范围、优先级、阶段定义只允许改本文件。
- 规则 2：其他文档若与本文件冲突，以本文件为准，并在 72 小时内同步。
- 规则 3：每次阶段变更必须同时更新“分期范围 + 验收标准 + 模块映射”。
- 规则 4：每周只做一次文档变更窗口，避免持续抖动。

---

## 9. 本周执行建议（不复杂版本）

1. 锁定 P1 的三个范围，不再扩增条目。
2. 先完成多语言字段与抽取链路最小闭环。
3. 增加对话式查询 API 的只读版本（先查证据链，不做复杂 agent 自动决策）。
4. 补齐 P1 的最小回归样例与验收脚本。

完成以上四项后，再进入 ACH 和叙事能力实现。
